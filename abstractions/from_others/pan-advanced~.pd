#N canvas 558 0 446 440 10;
#X obj 31 161 inlet~ signal;
#X obj 277 172 inlet panorama;
#X obj 31 405 outlet~ left;
#X obj 205 407 outlet~ right;
#N canvas 908 568 392 418 panner-work 0;
#X obj 159 55 inlet;
#X obj 27 347 outlet~;
#X obj 161 345 outlet~;
#X obj 27 33 inlet~;
#N canvas 24 224 678 690 HeadITDFilter 0;
#X obj 127 40 inlet theta;
#X obj 127 66 + 90;
#X obj 313 114 expr 334/0.08;
#X text 420 113 c / r of head;
#X text 328 133 w0;
#X obj 263 188 expr 1.025 + 0.975*cos(($f1/150)*3.14159);
#X text 276 207 alfa;
#X obj 385 143 samplerate~;
#X obj 210 259 expr ($f2 -$f1*$f3)/($f2+$f1*$f3);
#X text 216 242 zero;
#X text 240 282 pole;
#X obj 244 339 expr ($f2+$f1*$f3)/($f2+$f3);
#X text 255 324 scaler;
#X obj 232 299 expr ($f1 -$f2)/($f1+$f2);
#X obj 357 69 t b b;
#X obj 97 292 rpole~;
#X obj 97 268 rzero~;
#X obj 96 383 *~;
#X obj 142 365 line~;
#X msg 143 342 \$1 50;
#X text 48 332 IIR;
#X obj 98 237 inlet~;
#X text 493 290 HeadShadow;
#X floatatom 148 11 5 0 0 0 - - -;
#X obj 224 455 expr if(abs($f1)<90 \, (-$f3/$f2)*(cos($f1*3.14159/180)-1)
\, ($f3/$f2)*(abs($f1)-90)*3.14159/180 + 1);
#X obj 224 514 expr (1-$f1)/(1+$f1);
#X obj 95 564 outlet~;
#X obj 96 514 rpole~;
#X text 26 502 allpass;
#X obj 362 40 inlet trigger;
#X text 509 505 ITD;
#X obj 96 482 rzero_rev~;
#X text 245 489 group delay in samples;
#X connect 0 0 1 0;
#X connect 1 0 5 0;
#X connect 1 0 24 0;
#X connect 2 0 8 1;
#X connect 2 0 13 0;
#X connect 2 0 11 1;
#X connect 2 0 24 1;
#X connect 5 0 8 0;
#X connect 5 0 11 0;
#X connect 7 0 8 2;
#X connect 7 0 13 1;
#X connect 7 0 11 2;
#X connect 7 0 24 2;
#X connect 8 0 16 1;
#X connect 11 0 19 0;
#X connect 13 0 15 1;
#X connect 14 0 2 0;
#X connect 14 1 7 0;
#X connect 15 0 17 0;
#X connect 16 0 15 0;
#X connect 17 0 31 0;
#X connect 18 0 17 1;
#X connect 19 0 18 0;
#X connect 21 0 16 0;
#X connect 23 0 1 0;
#X connect 24 0 25 0;
#X connect 25 0 27 1;
#X connect 25 0 31 1;
#X connect 27 0 26 0;
#X connect 29 0 14 0;
#X connect 31 0 27 0;
#X restore 58 176 pd HeadITDFilter;
#X obj 216 136 loadbang;
#N canvas 712 224 678 690 HeadITDFilter 0;
#X obj 127 40 inlet theta;
#X obj 127 66 + 90;
#X obj 313 114 expr 334/0.08;
#X text 420 113 c / r of head;
#X text 328 133 w0;
#X obj 263 188 expr 1.025 + 0.975*cos(($f1/150)*3.14159);
#X text 276 207 alfa;
#X obj 385 143 samplerate~;
#X obj 210 259 expr ($f2 -$f1*$f3)/($f2+$f1*$f3);
#X text 216 242 zero;
#X text 240 282 pole;
#X obj 244 339 expr ($f2+$f1*$f3)/($f2+$f3);
#X text 255 324 scaler;
#X obj 232 299 expr ($f1 -$f2)/($f1+$f2);
#X obj 357 69 t b b;
#X obj 97 292 rpole~;
#X obj 97 268 rzero~;
#X obj 96 383 *~;
#X obj 142 365 line~;
#X msg 143 342 \$1 50;
#X text 48 332 IIR;
#X obj 98 237 inlet~;
#X text 493 290 HeadShadow;
#X floatatom 148 11 5 0 0 0 - - -;
#X obj 224 455 expr if(abs($f1)<90 \, (-$f3/$f2)*(cos($f1*3.14159/180)-1)
\, ($f3/$f2)*(abs($f1)-90)*3.14159/180 + 1);
#X obj 224 514 expr (1-$f1)/(1+$f1);
#X obj 95 564 outlet~;
#X obj 96 514 rpole~;
#X text 26 502 allpass;
#X obj 362 40 inlet trigger;
#X text 509 505 ITD;
#X obj 96 482 rzero_rev~;
#X text 245 489 group delay in samples;
#X connect 0 0 1 0;
#X connect 1 0 5 0;
#X connect 1 0 24 0;
#X connect 2 0 8 1;
#X connect 2 0 13 0;
#X connect 2 0 11 1;
#X connect 2 0 24 1;
#X connect 5 0 8 0;
#X connect 5 0 11 0;
#X connect 7 0 8 2;
#X connect 7 0 13 1;
#X connect 7 0 11 2;
#X connect 7 0 24 2;
#X connect 8 0 16 1;
#X connect 11 0 19 0;
#X connect 13 0 15 1;
#X connect 14 0 2 0;
#X connect 14 1 7 0;
#X connect 15 0 17 0;
#X connect 16 0 15 0;
#X connect 17 0 31 0;
#X connect 18 0 17 1;
#X connect 19 0 18 0;
#X connect 21 0 16 0;
#X connect 23 0 1 0;
#X connect 24 0 25 0;
#X connect 25 0 27 1;
#X connect 25 0 31 1;
#X connect 27 0 26 0;
#X connect 29 0 14 0;
#X connect 31 0 27 0;
#X restore 116 210 pd HeadITDFilter;
#X obj 162 120 * -1;
#X connect 0 0 4 1;
#X connect 0 0 7 0;
#X connect 3 0 4 0;
#X connect 3 0 6 0;
#X connect 4 0 1 0;
#X connect 5 0 4 2;
#X connect 5 0 6 2;
#X connect 6 0 2 0;
#X connect 7 0 6 1;
#X restore 32 345 pd panner-work;
#X obj 105 294 hsl 85 12 -50 50 0 0 empty empty empty -2 -8 0 10 -260818
-1 -1 4200 1;
#X obj 102 237 loadbang;
#X msg 102 258 0;
#X text 280 154 -50 ... 50 degree;
#X floatatom 102 308 5 0 0 1 degree - -;
#X text 12 16 ADVANCED STEREO PANNER;
#X text 9 53 This panner tries to model the filtering effect of the
head shadow (with an IIR filter) and the Interaural Time Differences
(with an allpass filter).;
#X text 9 101 For a description of the algorithm see the DAFX book
\, page 155-157 !;
#X connect 0 0 4 0;
#X connect 1 0 5 0;
#X connect 4 0 2 0;
#X connect 4 1 3 0;
#X connect 5 0 9 0;
#X connect 6 0 7 0;
#X connect 7 0 5 0;
#X connect 9 0 4 1;
#X coords 0 -1 1 1 94 44 1 100 280;
